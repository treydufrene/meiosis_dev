\documentclass[12pt]{report}
\usepackage[margin=1in]{geometry}
\usepackage{setspace} % for single/doublespacing commands
\usepackage{graphicx} % including graphics
\usepackage{sectsty} % sexy section headings
\usepackage{pdfpages} % including multipage pdfs
\usepackage[export]{adjustbox} % for graphic frames and center
\usepackage{siunitx}
\usepackage[numbered]{matlab-prettifier} % including matlab w/ syntax highlighting
\usepackage[T1]{fontenc} % prettier matlab font
\usepackage{xfrac} % more legible inline fractions (\sfrac)
\usepackage{lmodern} % font package for above
\usepackage{multicol} % multiple columns
\usepackage[justification=centering]{caption} % figure captions (force centering)
\usepackage{amsmath} % more math symbols and shit
\usepackage{enumitem} % add arguments for enumerate to change style
\usepackage[list=true]{subcaption} % subfigures with list of figure support
\usepackage{multirow}
\usepackage{mathtools}
\usepackage{booktabs}
\usepackage{color}
\usepackage{ulem}
\usepackage{blindtext}
\usepackage[numbers]{natbib}
\usepackage{contour}
\usepackage{tabularx}
\usepackage{circuitikz} % drawing fancy shit
\usepackage{cancel} % arrow and cross math cancel symbol
\usepackage{lineno}
\usepackage{framed}
\usepackage{amssymb} % special math symbols
\usepackage{listings}
\usepackage{array}
\usepackage{BOONDOX-cal} % fancy mathtype script
\usepackage{fancyhdr}
\usepackage{flowchart}
\usepackage{color, colortbl}
\usepackage{tocloft}
\usepackage{url}
\usepackage{etoolbox}
\usepackage{hyperref}

\setlength{\parskip}{\baselineskip}%
\setlength{\parindent}{0pt}%
\setcounter{secnumdepth}{5}
\renewcommand{\bibname}{References}
\sisetup{output-exponent-marker=\ensuremath{\mathrm{e}}}
\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
\newcolumntype{R}[1]{>{\PreserveBackslash\raggedleft}p{#1}}
\newcolumntype{L}[1]{>{\PreserveBackslash\raggedright}p{#1}}
\lstMakeShortInline[style=Matlab-editor]| % matlab inline escape character
\graphicspath{{images/}}
\renewcommand\thesection{\arabic{section}}
\renewcommand\labelitemi{---}
\lstset{numberstyle=\ttfamily\small\color{gray}}
\renewcommand\linenumberfont{\ttfamily\small\color{gray}}
\setlength\linenumbersep{6mm}
% \hbadness=99999  % or any number >=10000
\apptocmd{\sloppy}{\hbadness 10000\relax}{}{}
\usetikzlibrary{arrows,calc,patterns,angles,quotes}
% \usetikzlibrary{shapes.geometric}
% \usetikzlibrary{decorations.pathmorphing,decorations.pathreplacing} % for snakes!
% \usetikzlibrary{positioning, circuits.logic.US}
\setlength{\cftbeforetoctitleskip}{-2em}
\newcommand{\Lag}{\mathcal{L}} % lagrangian L

\apptocmd{\sloppy}{\hbadness 10000\relax}{}{}
\setlength{\cftbeforetoctitleskip}{-2em}
\allsectionsfont{\raggedright}
\setlist[enumerate]{wide=0pt, widest=99,
                    leftmargin=\parindent,topsep=0pt,partopsep=0pt,
                    label=\thesubsubsection.\alph*,font=\itshape}
\begin{document}
\normalem
\input{coverpage}
\pagenumbering{roman}
% \begin{abstract}
  % Wordy words
% \end{abstract}
{\tableofcontents\let\clearpage\relax\listoffigures\let\clearpage\relax\listoftables}
\clearpage
\newpage

% \section*{List Of Acronyms and Abbreviations}

% \begin{tabular}{rl}
%   $G$~:&Center of gravity of the bar \\
%   $\ell_0$~:& Spring unstretched length  \\
%   $\delta$~:& Spring deflection \\
%   $k$~:& Spring constant \\
%   $h_{b}$~:& Distance to bar ($G$) from datum \\
%   $F_s$~:& Force onto bar due to spring\\
%   $A_{n}$~:& Pin reaction in $\theta$ direction\\
%   $A_{t}$~:& Pin reaction in tangential direction \\
%   $\vec{v}_G$~:& Velocity of bar center of gravity\\
%   $\ddot{\theta}$~:& Angular velocity of spring \\
%   $\ddot{\phi}$~:& Angular velocity of bar\\
%   $\ddot{\ell}_s$~:& Radial acceleration of spring \\
% \end{tabular}
% \normalsize
% \flushleft
% \singlespacing
% \newpage

\pagenumbering{arabic}

\section{Forward Kinematics}
% \input{fk}
\begin{table}[htp]
  \center
  \caption{DH Table for 6 DOF Manipulator}
  \label{table:dh}
  \begin{tabular}{C{1cm}|C{1.5cm}|C{2cm}|C{1cm}|C{1cm}}
    DH & $d_i$ & $\theta_i$ & $a_i$ & $\alpha_i$ \\ \hline
    1 & $\ell_1$ & $\theta_1$ & 0 & $\sfrac{\pi}{2}$ \\
    2 & $-d$ & $\theta_2$ & $\ell_2$ & 0 \\
    3 & 0 & $\theta_3 + \sfrac{\pi}{2}$ & 0 & $\sfrac{\pi}{2}$ \\
    4 & $\ell_3 + \ell_4$ & $\theta_4$ & 0 & $-\sfrac{\pi}{2}$ \\
    5 & 0 & $\theta_5$ & 0 & $\sfrac{\pi}{2}$ \\
    6 & $\ell_6$ & $\theta_6$ & 0 & 0 \\
  \end{tabular}
\end{table}
Where \(\ell_1 = 22.08\)cm, \(\ell_2 = 25\)cm, \(\ell_3 = 20\)cm, \(\ell_4 = 8\)cm, \(\ell_6 = 5.25\)cm, and \(d = 1\)cm.
\begin{equation}
A = Rot_{z,\theta}~Trans_{z,d}~Trans_{x,a}~Rot_{x,\alpha}
\label{eq:J1}
\end{equation}%
Given an arbitrary homogeneous matrix $T_i^{i-1}$ (computed by matrix multiplication of $A$ matrices $\rightarrow \big[A_1A_2\cdots A_{i-1}A_i\big]$), the orientation vector $\bar{z}_i$ (with respect to $\varphi$, $\theta$ and $\psi$) and the relative joint position (displacement) vector $\bar{o}_i$ (with respect to $x$, $y$, and $z$) can be obtained via the 3$^{rd}$ and 4$^{th}$ columns of the matrix respectively,
as shown in Equation \ref{eq:J2} (given $\beta$ as an arbitrary rotation angle about the $z$-axis).
\begin{equation}
  T_i^{i-1} =
\begin{bmatrix}
  c_{\beta} & -s_{\beta} & z_i^{\varphi} & o_i^x \\
  s_{\beta} & c_{\beta} & z_i^{\theta} & o_i^y \\
  0 & 0 & z_i^{\psi} & o_i^z \\
  0 & 0 & 0 & 1 \\
\end{bmatrix}
\label{eq:J2}
\end{equation}

\[
A_1 = rotz(\theta_1) ~ transz(\ell_1) ~ rotx(\sfrac{\pi}{2})
\]
\vspace{.25ex}
\[
A_1 =
\begin{bmatrix}
  \cos(\theta_1) & 0 & \sin(\theta_1) & 0 \\
  \sin(\theta_1) & 0 & -\cos(\theta_1) & 0 \\
  0 & 1 & 0 & 22.08 \\
  0 & 0 & 0 & 1 \\
\end{bmatrix}
\]
\vspace{.25ex}
\[
A_2 = rotz(\theta_2) ~ transz(-d) ~ transx(\ell_2)
\]
\vspace{.25ex}
\[
A_2 =
\begin{bmatrix}
  \cos(\theta_2) & -\sin(\theta_2) & 0 & 25\cos(\theta_2) \\
  \sin(\theta_2) & \cos(\theta_2) & 0 & 25\sin(\theta_2) \\
  0 & 0 & 1 & -1 \\
  0 & 0 & 0 & 1 \\
\end{bmatrix}
\]
\vspace{.25ex}
\[
A_3 = rotz(\theta_3 + \sfrac{\pi}{2}) ~ rotx(\sfrac{\pi}{2})
\]
\vspace{.25ex}
\[
A_3 =
\begin{bmatrix}
  \cos(\theta_3 +  \sfrac{\pi}{2}) & 0 & \sin(\theta_3 +  \sfrac{\pi}{2}) & 0 \\
  \sin(\theta_3 +  \sfrac{\pi}{2}) & 0 & -\cos(\theta_3 +  \sfrac{\pi}{2}) & 0 \\
  0 & 1 & 0 & 0 \\
  0 & 0 & 0 & 1 \\
\end{bmatrix}
\]
\vspace{.25ex}
\[
A_4 = rotz(\theta_4) ~ transz(\ell_3 + \ell_4) ~ rotx(-\sfrac{\pi}{2})
\]
\vspace{.25ex}
\[
A_4 =
\begin{bmatrix}
  \cos(\theta_4) & 0 & -\sin(\theta_4) & 0 \\
  \sin(\theta_4) & 0 & \cos(\theta_4) & 0 \\
  0 & -1 & 0 & 28 \\
  0 & 0 & 0 & 1 \\
\end{bmatrix}
\]
\vspace{.25ex}
\[
A_5 = rotz(\theta_5) ~ rotx(\sfrac{\pi}{2})
\]
\vspace{.25ex}
\[
A_5 =
\begin{bmatrix}
  \cos(\theta_5) & 0 & \sin(\theta_5) & 0 \\
  \sin(\theta_5) & 0 & -\cos(\theta_5) & 0 \\
  0 & 1 & 0 & 0 \\
  0 & 0 & 0 & 1 \\
\end{bmatrix}
\]
\vspace{.25ex}
\[
A_6 = rotz(\theta_6) ~ transz(\ell_6)
\]
\vspace{.5ex}
\[
A_6 =
\begin{bmatrix}
  \cos(\theta_6) & 0 & -\sin(\theta_6) & 0 \\
  \sin(\theta_6) & 0 & \cos(\theta_6) & 0 \\
  0 & 0 & 1 & 5.25 \\
  0 & 0 & 0 & 1 \\
\end{bmatrix}
\]

\newpage

\section{Motor Dynamics}
\begin{equation}
  H(\gamma)\ddot{\gamma} + n(\gamma,\dot{\gamma}) = \tau
  \label{eq:rdyn}
\end{equation}

\begin{equation}
  \tau_a = Ki_a = J_a\ddot{\theta}_a + b_a\ddot{\theta}_a + \tau_L
  \label{eq:pd}
\end{equation}


\begin{equation}
  V_a = i_aR_a + K\dot{\theta}_a
  \label{eq:va}
\end{equation}

Given a gearbox with $\sfrac{\text{in}}{\text{out}}$ ratio $N$ and efficiency $\eta$,
\begin{center}
\begin{tikzpicture}
\pgfmathsetmacro{\cubex}{1}
\pgfmathsetmacro{\cubey}{1}
\pgfmathsetmacro{\cubez}{1}
\draw (0,0,0) -- ++(-\cubex,0,0) -- ++(0,-\cubey,0) -- ++(\cubex,0,0) -- cycle;
\draw (0,0,0) -- ++(0,0,-\cubez) -- ++(0,-\cubey,0) -- ++(0,0,\cubez);
\draw (0,0,0) -- ++(-\cubex,0,0) -- ++(0,0,-\cubez) -- ++(\cubex,0,0);
\draw (-2,-.5,-.5) -- ++(.8,0,0) node(a)[midway,above]{} node(b)[midway]{} node(c)[midway,below]{};
\pic [draw,angle radius=5,<-] {angle = a--b--c};
\node at (-2.25,0,-.5) {\small $\theta_a$};
\node at (-2.25,-1,-.5) {\small $\tau_{in}$};
\draw (0,-.5,-.5) -- ++(1,0,0);
\draw (0,-.5,-.5) -- ++(1,0,0) node(a1)[midway,above]{} node(b1)[midway]{} node(c1)[midway,below]{};
\pic [draw,angle radius=5,<-] {angle = a1--b1--c1};
\node at (1.5,0,-.5) {\small $\theta=\frac{\theta_a}{N}$};
\node at (1.5,-1,-.5) {\small $\tau_{out}=\tau_{in}N\eta$};
\node at (-.5,-.5,0) {$N$};
\end{tikzpicture}
\end{center}
The motor equations can be expressed in the output coordinates:
\[
Ki_a = J_aN\ddot{\theta} + b_aN\dot{\theta} + \frac{\tau}{N\eta}
\]
Substituing into equation (\ref{eq:va}) and solving for $i_a$:
\[
  i_a = \frac{J_aN}{K}\ddot{\theta} + b_aN\dot{\theta} + \frac{\tau}{N\eta}
\]
\begin{equation}
  V_a = \frac{R_aJ_aN}{K}\ddot{\theta} + \frac{R_ab_aN}{K}\dot{\theta} + \frac{R_a}{KN\eta}\tau + KN\dot{\theta}
  \label{eq:newva}
\end{equation}
Assuming P.D. control: \(V_a = K_p(\theta-\theta_d) + K_d\dot{\theta}\), setting equal to \ref{eq:newva}, then collecting like terms:
\begin{equation}
  \frac{R_aJ_aN}{K}\ddot{\theta} + \left( \frac{R_aJ_aN}{K} - K_d + KN \right)\dot{\theta} - K_p\theta = -K_p\theta_d - \frac{R_a}{KN\eta}\tau
\end{equation}
\begin{equation}
  2\zeta\omega_n = \frac{b_a}{J_a} - \frac{KK_d}{R_aJ_aN} + \frac{K^2}{R_aJ_a}
\end{equation}
\begin{equation}
  \omega_n^2 = \frac{-KK_p}{R_aJ_aN}
\end{equation}

\begin{equation}
  \text{\% Overshoot} = \left( \frac{\theta_{max} - \theta_{ss}}{\theta_{ss}} \right) \cdot 100
\end{equation}

\begin{equation}
  \zeta = \frac{-\ln(\sfrac{\%\text{OS}}{100})}{\sqrt{\pi^2 + \ln^2(\sfrac{\%\text{OS}}{100})}}
\end{equation}

\begin{equation}
  \omega_n = \frac{\pi}{T_p\sqrt{1-\zeta^2}}
\end{equation}

\begin{equation}
  2\zeta\omega_n = \frac{R_ab_aN^2\eta-KK_dN\eta+K^2N^2\eta}{R_aJ_aN^2\eta+R_aJ_m}
\end{equation}

\begin{equation}
  \omega_n =-\frac{KK_pN\eta}{R_aJ_aN^2\eta+R_aJ_m}
\end{equation}



% The dynamical





% Example citations:
% \cite{DBLP:journals/corr/JohnsonAL16}
% \cite{DBLP:journals/corr/abs-1803-09820}
% \cite{DBLP:journals/corr/RonnebergerFB15}





% \begin{enumerate}[label=\alph*.]
%   \item Description for callout a
%   \item Description for callout b
% \end{enumerate}


% \newpage
% \bibliographystyle{plain}
% \bibliography{JohnsonAL16,abs-1803-09820,RonnebergerFB15}

% \newpage
% \section*{Acknowledgements \& Attributions}
% \begin{itemize}
%   \item People!
% \end{itemize}
% \newpage

% \newpage
% \appendix
% \renewcommand\thesection{\Roman{section}}
% \renewcommand\thesubsection{\roman{subsection}}
% \section*{Appendix}\label{sec:app}
% Code listing
%\begin{lstlisting}[frame=lines,style=Matlab-editor,basicstyle = \mlttfamily, caption=Example Code
% Code Here
%\end{lstlisting}

% \includepdf[landscape,pages=-]{pdfname}

\end{document}

\input{preamble}
\begin{document}
\normalem
\input{coverpage}
\pagenumbering{roman}
\begin{abstract}
The Manipulator for Educational Institutions with Open Source Integrated Systems (MEIOSIS) aims to increase the accessibility of robotics to secondary educational institutions and hobbyists. Accordantly, the manipulator is 3D printed in PLA with aluminum tube supports and costs the end-user less than \$1000. The manipulator has six links and a base. The base houses a Raspberry Pi 3B and power supply. The Raspberry Pi controls seven Dynamixel smart servos with position feedback and proportional derivative control. Six MX-12W servos actuate six rotational joints, while one AX-12A servo actuates the removable end-effector. They provide the manipulator a position repeatability within 2mm of the previous pose. The manipulator can draw as well as perform pick and place operations within its dexterous workspace which is a hemispherical sub-shell of the reachable workspace of 280 mm thickness. The manipulator’s operation is controlled by open-source software.
\end{abstract}
% {\tableofcontents\let\clearpage\relax\listoffigures\let\clearpage\relax}
{\tableofcontents\clearpage\listoffigures\listoftables}
\clearpage
\newpage
\section*{List Of Acronyms and Abbreviations}
\begin{tabular}{rcl}
  FK &:& Forward Kinematics \\
  IK &:& Inverse Kinematics  \\
  PD &:& Proportional Derivative \\
  % $k$~:& Spring constant \\
  % $h_{b}$~:& Distance to bar ($G$) from datum \\
  % $F_s$~:& Force onto bar due to spring\\
\end{tabular}

\section*{Notation}\vspace{-\baselineskip}
\renewcommand{\arraystretch}{2.25}
\begin{tabular}{rcl}
\large%
\(
{}^{\text{\scriptsize Frame}}_{\text{\scriptsize From}}~{r}~_{\text{\scriptsize To}}
\)\normalsize &:& Direction Vectors\\
\(
{}^{\text{\scriptsize From}}~{T}~_{\text{\scriptsize To}}
\)\normalsize &:& Direction Cosine (Transformation) Matrices \\
\(c_{\theta_{nm}}\)&:& \( \cos(\theta_n + \theta_m)\)\\
\(s_{\theta_{nm}}\)&:& \( \sin(\theta_n + \theta_m)\) \\
\end{tabular}
\renewcommand{\arraystretch}{1}
\newpage

\pagenumbering{arabic}
\section{Introduction}
The Manipulator for Educational Institutions with Open Source Integrated Systems (MEIOSIS) aims to increase the accessibility of robotics education to high school students and hobbyists. Contained within this document is the design of a manipulator to fulfil this end. It will address the manipulator’s conceptual design with requirements defining specification therefrom. A detailed design with motor descriptions introduces the manipulator’s kinematics and simulations, concluding with a description of the system's operation and plans for implementation.
\section{Requirements}
The requirements of the system concisely define the capabilities the system must possess in order to solve the stated problem.
\input{requirements}
\newpage
\section{Conceptual Design}
\input{concept}
\newpage
\section{Specifications}
\input{specs}
\newpage
\section{Preliminary Design}
The preliminary design section represents the most up-to-date status of the project and also encompasses information pertaining to several different specific design choices that had to be considered. The computer aided design section contains information regarding the physical design of the manipulator as well as noting key design features; the actuator analysis section contains information regarding actuator considerations and calculations being that the servo motors play an essential role in the functionality of the final system.
\subsection{Computer Aided Design}
The manipulator will be six degrees of freedom and will feature a spherical wrist. This design incorporates two different differential drive gearboxes that each control two degrees of freedom. This is to reduce the amount of required torques from the motors on the shoulder joint and reduce size in the wrist. In order to achieve accuracy requirements, timing belts are incorporated into the design in order to control the first three degrees of freedom. The following figure shows the join configuration used in the design of the manipulator.

\begin{figure}[htp]
  \center
  \includegraphics[width=.85\textwidth,frame]{meiosis_zeroed}
  \caption{Manipulator in Zeroed Configuration with Callouts}
  \label{fig:meiosis_zeroed}
\end{figure}
\emph{Figure \ref{fig:meiosis_zeroed}} shows the zeroed configuration for the manipulator with callouts showing the link locations.
\begin{enumerate}[label=\alph*.]
  \item The \emph{Manipulator Base} is designed to hold the Raspberry Pi and power supply. The base features holes for airflow and I/O connections.
  \item \emph{Link 1 \& Differential Drive} have three bevel gears to create the first differential drive rotational joint of the manipulator.
  \item \emph{Link 2} has servos located at the end of the link to control the movement for the first two degrees of freedom at the shoulder and are connected to link 1 using timing belts.
  \item \emph{Link 3} contains two servos attached to the link that control the third degree of freedom (the elbow) and the fourth degree of freedom which is the first degree of freedom for the wrist.
  \item \emph{Link 4 }houses the servos used to control the fifth and sixth degree of freedom, which are both in the wrist’s differential drive gearbox.
  \item \emph{Link 5} provides support for the wrist’s differential drive gearbox.
  \item The \emph{End Effector} features connection points to hold a Dynamixel AX-12A smart servo.
\end{enumerate}
% \emph{Figure \ref{fig:meiosis_zeroed}} shows the zeroed configuration for the manipulator with callouts showing the link locations. Point (a) shows the base of the manipulator. This is designed to hold the Raspberry Pi and power supply. The base features holes for airflow and I/O connections. Point (b) shows the first link of the robot and is the location of the first differential drive gearbox. Point (c) shows the second link of the robot, the servos located at the end of the link control the movement for the first two degrees of freedom at the shoulder and are connected to link 1 using timing belts. Point (d) shows the third link of the robot, there are two servos attached to the link that control the third degree of freedom (the elbow) and the fourth degree of freedom which is the first degree of freedom for the wrist. Point (e) shows the fourth link of the manipulator which houses the servos used to control the fifth and sixth degree of freedom, which are both in the wrist’s differential drive gearbox. Point (f) shows the fifth and final link of the robot. This link is support for the wrist’s differential drive gearbox. Finally, point (g) shows the end effector which features connection points to hold a Dynamixel AX-12A smart servo. The next figure shows key features that are unique to links two and three.

\begin{figure}[htp]
  \center
  \includegraphics[width=.85\textwidth,frame]{linkx}
  \caption{Link Cross Section}
  \label{fig:linkx}
\end{figure}

\emph{Figure \ref{fig:linkx}} shows the cross-section for link two with callouts for key features in the design.
\begin{enumerate}[label=\alph*.]
  \item \emph{Clamping mechanisms} connect the aluminum pipe to the 3-D printed parts. This will allow for an easy way to assemble the manipulator while allowing for a large amount of tolerance in the length of the pipe when manufacturing the part.
  \item Shows an example of the gaps between the aluminum pipe and the 3-D printed parts.
  \item Shows where the 3-D printed parts will line up to ensure that the link is the correct length and orientation.
\end{enumerate}
% Point (a) shows two clamping mechanisms that will be used to connect the aluminum pipe to the 3-D printed parts. This will allow for an easy way to assemble the manipulator while allowing for a large amount of tolerance in the length of the pipe when manufacturing the part. Point (b) shows an example of the gaps between the aluminum pipe and the 3-D printed parts. Point (c) shows where the 3-D printed parts will line up to ensure that the link is the correct length and orientation.
\emph{Figure \ref{fig:assy_mech}} contains an image of the design utilized to keep the assembly of the robot easy and practical.
\newpage

\begin{figure}[htp]
  \center
  \includegraphics[width=.65\textwidth,frame]{assy_mech}
  \caption{Link 4 Assembly Mechanism}
  \label{fig:assy_mech}
\end{figure}

\emph{Figure \ref{fig:assy_mech}}  shows the link in the wrist that utilizes a special design to ensure proper assembly. The link itself is two parts which connect together on both sides of the link at point (a), this allows for the differential gearbox to be assembled and inserted into the wrist without interference from link 4. Once assembled, the link will attach to the smart servo at point (b).



\subsubsection{Pulleys}
A 12 tooth and 120 tooth pulleys provide a 10:1 gear ratio and use a 0.25 in wide MXL belt. The center distance between the pulleys must be at least 5.43 in to have 5 teeth meshing. Because of the high gear ratio, greater distances do not increase the number of teeth in mesh. \emph{Figure \ref{fig:pulley12}} shows the distance between the manipulator’s first two pulleys is 235.185 mm or 9.259 in, which corresponds to a belt with 300 and pitch diameter of 24 in.
\begin{figure}[htp]
  \center
  \includegraphics[width=.65\textwidth,frame]{pulley12}
  \caption{Pulley 1-2 Center Distance}
  \label{fig:pulley12}
\end{figure}
\emph{Figure \ref{fig:pulley3}} shows the center distance between the second pulleys is 139.960 mm or 5.510 in. The corresponding belt has 208 teeth with a 16.6 in pitch diameter.
\begin{figure}[htp]
  \center
  \includegraphics[width=.65\textwidth,frame]{pulley3}
  \caption{Pulley 3 Center Distance}
  \label{fig:pulley3}
\end{figure}
\subsection{Actuator Analysis}
Dynamixel does not provide a stall torque for the MX-12W servo, however it does provide stall torque data for two similar servos. The MX-12W’s stall torque can be found from the stall torque data since the motor are the same. The stall torque of the MX-12W should be comparable to the AX-12W’s stall torque. The MX-12W and AX-12W operate at the same 12 V voltage, 32:1 gear ratio, and 470 rpm no load output speed. The AX-12A also operates at 12 V, but at with a 254:1 gear ratio and 59 rpm no load output speed. Torque and current are inversely related. If the AX-12A’s and AX-12W’s motors are the same, then when operating at the same voltage, the output speed of the AX-12W should equal to the output speed of the AX-12A multiplied by the ratio of the servos’ gear ratios and the torque of the AX-12W should be the AX-12A’s torque multiplied by the inverse of the gear ratios ratio:
\[ 59\cdot\frac{254}{32}=468 \cong 470 \]
The AX-12A’s and MX-12W’s stall torques are 1.5Nm and 0.21Nm, respectively \cite{dyna}:
\[ 1.5\cdot\frac{32}{254}=0.189\cong0.21\text{Nm} \]
Therefore, the AX-12A and MX-12W use the same motor. Additionally, if operating at the same voltage, the stall torque is defined by the no load output speed and gear ratio. Since the MX-12W and AX-12A operate at the same 12 V voltage with the same 32:1 gear ratio and 470 rpm no load output speed, their stall torques should be the same. More specifically, it is between the AX-12W’s and the gear reduced AX-12A’s stall torques of 0.21Nm and 0.189Nm, respectively. Therefore, the stall MX-12W’s stall torque is within 0.01Nm of 0.2Nm. The manipulator is designed for the worst case scenario: 0.19 Nm.

The first differential has its greatest torque when the manipulator is in the zeroed configuration. In the zeroed configuration, the arm is outstretched with gravity acting perpendicular to the arm’s length. Since the manipulator must only support a chisel tip dry erase Expo marker, the maximum torque may be approximated as the manipulator’s arm’s mass acting acting near the centroid. More mass from the servos and longer aluminum support in link 3 place the center of mass closer to the end-effector than the base. Therefore, the point at which the arm’s mass acts is assumed to be 273 mm from the base. These calculations will be further revised with mass parameters from the STL files generating the open and closed loop simulations. \emph{Table \ref{tab:arm1}} estimates the manipulator’s arm’s mass.
\begin{table}[htp]
  \center
  \caption{Manipulator Link 1 Mass Tabulations}
  \label{tab:arm1}
\begin{tabular}{cc|cc}
  \textbf{Item} & \textbf{Specifications} & \textbf{Weight (g)} & \textbf{Notes} \\\hline
  3-D Printed Materials & 30\% infill & 353 & 100\% infill: 1177g \\
  Servos & 7 low torque & 385 & 55 $\sfrac{\text{g}}{\text{servo}}$ \\
  Aluminum Support & .75$''$  OD .125$''$  thick 1$'$ long & 287 & 44.23 $\sfrac{\text{g}}{\text{in}}^3$ \\
  Bearings & 5 bearings & 60 & 12 $\sfrac{\text{g}}{\text{bearing}}$ \\
  End Effector & & 50 & Approx. \\
  Safety Factor & & 205 & \\
  & \textbf{Total} & 1340 & \\
\end{tabular}
\end{table}

The total mass of 1340g as seen in \emph{Table \ref{tab:arm1}} yields a moment of 0.361 Nm or 3.685 kgm. To generate smooth motions, Dynamixel recommends operating at one fifth of the stall torque. Therefore, the actual maximum required torque is 1.805 Nm. An MX-12W provides 0.19 Nm of torque, necessitating a 10:1 gear ratio. While the AX-12A provides a greater torque of 1.5 Nm, it would also require gearing. It is only precise to 0.8 degrees, while the specifications require at least 0.29 degrees of precision for joints one and two. Further, the AX-12A only receives position feedback for 300 degrees of its rotation and cannot track multiple rotations, making it untenable for the base motor, which must rotate more than 360 degrees.

The third joint’s torque requirements can be approximated in the same manner. However, links three, four, and five’s masses are assumed to act 200 mm from the third joint 3. \emph{Table \ref{tab:arm2}} estimates the links’ masses.

\begin{table}[htp]
  \center
  \caption{Manipulator Link 2 Mass Tabulations}
  \label{tab:arm2}
\begin{tabular}{cc|cc}
\textbf{Item} & \textbf{Specifications} & \textbf{Weight (g)} & \textbf{Notes} \\\hline
3-D Printed Materials & 30\% infill & 180 & 100\% infill: 1177g \\
Servos & 4 low torque & 220 & 55 $\sfrac{\text{g}}{\text{servo}}$ \\
Aluminum Support & .75$''$ OD .125$''$ thick 1$'$ long & 140 & 44.23 $\sfrac{\text{g}}{\text{in}}^3$ \\
Bearings & 5 bearings & 36 & 12 $\sfrac{\text{g}}{\text{bearing}}$ \\
End Effector & & 50 & Approx. \\
Safety & & 205 & \\
& \textbf{Total} & 831 & \\
\end{tabular}
\end{table}

The resulting moment is 1.630 Nm, which can be satisfied by the same motor and gear ratio used on the base.

\subsection{Forward Kinematics}
\input{fk}
\subsection{Velocity Kinematics}
The translational and rotational velocties ($\dot{r}$ \& $\omega$) can be found given the geometric jacobian of the body and transformation matrix corresponding to it.
\[
\begin{bmatrix}
  ^B_B\omega_I\\
  ^I_B\dot{r}_B
\end{bmatrix}
= J_B =
\begin{bmatrix}
  ^IT_B(:,3)^T \cdot \dfrac{\partial}{\partial\gamma}{}^IT_B(:,2) \\
  ^IT_B(:,1)^T \cdot \dfrac{\partial}{\partial\gamma}{}^IT_B(:,3) \\
  ^IT_B(:,2)^T \cdot \dfrac{\partial}{\partial\gamma}{}^IT_B(:,1) \\
\end{bmatrix}
\]

\subsection{Inverse Kinematics}
The inverse kinematics can be calculated given desired position and orientation vectors, $o$ and $R$, respecitvely.
\[
\begin{bmatrix}x_c & y_c & z_c \end{bmatrix} = o~,\quad
  R =
  \begin{bmatrix}
    r_{11} & r_{12} & r_{13} \\
    r_{21} & r_{22} & r_{23} \\
    r_{31} & r_{32} & r_{33}
  \end{bmatrix}
\]
\begin{equation}
\begin{aligned}
\text{Inverse Position:}\qquad\qquad&\\
\theta_{1}&= \text{atan2} \left(x_{c},~ y_{c}\right) - \sfrac{\pi}{2}\\
\theta_{2}&= \text{atan2} \left(z_c - \ell_1, ~\sqrt{x_c^2 + y_c^2}\right) - \text{atan2}\left(\ell_3s_3,~\ell_2 + \ell_3c_3\right) \\
\theta_{3}&= \text{atan2} (-\sqrt{1-D^{2}},~ D) \\
& \quad \text { where } D\equiv\frac{x_{c}^{2}+y_{c}^{2}+\left(z_{c}-\ell_{1}\right)^{2}-\ell_{2}^{2}-\ell_{3}^{2}}{2 \ell_{2} \ell_{3}} \\
\text{Inverse Orientation}:\qquad\qquad&\\
^IT_3 &= rotz(\theta_1)~rotx(\theta_2)~rotx(\theta_3) \\
{}^3T_6 &= {}^IT_3^TR \\ % TODO: reference the FK orientation sec#/p.
\theta_4 &= \text{atan2} \left({}^3T_{6(1,2)},~{}^3T_{6(3,2)}\right) \\
\theta_5 &= \text{atan2} \left({{}^3T_{6(3,2)}} / {c_4},~{}^3T_{6(2,2)}\right) \\
\theta_6 &= \text{atan2} \left({}^3T_{6(2,1)},~ -{}^3T_{6(2,3)}\right) \\
\end{aligned}
\nonumber
\end{equation}
% \newpage

\subsection{Equations of Motion}
Given robot dynamics described by \(H(\gamma) \ddot{\gamma}+d(\gamma, \dot{\gamma})+G(\gamma)=F_{\gamma},\) the equations of motion for
the manipulator can be determined. Solving this equation for the acceleration, \(\ddot{\gamma}\), gives:
\begin{equation}
  \ddot{\gamma}=H(\gamma)^{-1}\left(F_{\gamma}-d(\gamma, \dot{\gamma})-G(\gamma)\right)
  \label{eq:eoms}
\end{equation}
Where $H$ is the system mass matrix, $F_{\gamma}$ is the vector of generalized forces, $d$ is the vector of centripital and coriolis effects, and $G$ is gravitational effects.
\[
  \renewcommand{\arraystretch}{1.5}
  H(\gamma) = \sum_B^N J_B(\gamma)^T
  \begin{bmatrix}
    ^B_BJ & \mathring{S}(^B_B\Gamma) ^IT_B^T\\
    ^IT_B\mathring{S}(^B_B\Gamma)^T & m_BI
  \end{bmatrix}
  J_B(\gamma)~,\quad
  ^B_B\Gamma = ^B_Br_{cm}m_b~,\quad \mathring{S}(\omega)r=(\omega\times r)
\]
\[
  \renewcommand{\arraystretch}{1.5}
  d(\gamma,\dot{\gamma}) = \sum_B^N J_B(\gamma)^T
  \begin{bmatrix}
    ^B_BJ & \mathring{S}(^B_B\Gamma) ^IT_B^T\\
    ^IT_B\mathring{S}(^B_B\Gamma)^T & m_BI
  \end{bmatrix}
  \dot{J}_B(\gamma,\dot{\gamma})\dot{\gamma}+J_B(\gamma)^T
  \begin{bmatrix}
    ^B_B\omega_I \times ^B_BJ ^B_B\omega_I \\
    ^IT_B\left(^B_B\omega_I\times(^B_B\omega_I\times^B_B\Gamma)\right)
  \end{bmatrix}
\]
\[
G(\gamma) = \left(\frac{\partial U(^Ir(\gamma))}{\partial\gamma}\right)^T~,\quad U_B = \begin{bmatrix} 0 & 0 & g\end{bmatrix}\left(^I_Br_Bm_B + ^IT_B{}_B^B\Gamma\right)
\]
Where $J_B$ is the jacobian of the body, $\Gamma$ is the vector of first mass moments, $m_B$ is the mass of the body, and $^B_B\omega_I$ is the rotational velocity of the body relative to the inertial frame.
\subsubsection{Actuator Dynamics}
\input{motor}
\subsection{Open-Loop Simulation}
The equations of motion described in equation (\ref{eq:eoms}) can be integrated to simulate the motion of the system. For the open loop control, no input torque is supplied, meaning the system responds only to gravity. Due to the complexity of the equations of motion, they will be integrated numerically using a 4th Order Runge-Kutta method algorithm \cite{mit}. Since no input force is supplied, the equations of motion reduce down to the relation described in equation (\ref{eq:eoms2}).

\begin{equation}
\ddot{\gamma}=H(\gamma)^{-1}(-d(\gamma, \dot{\gamma})-G(\gamma))
\label{eq:eoms2}
\end{equation}

The resulting simulation shows the manipulator assembly starting in the zeroed configuration, (\emph{Figure \ref{fig:olsnap1}}) then "falling" due to the forces of gravity acting on the links (\emph{Figure \ref{fig:olsnap2}}). The manipulator continues to oscillate analogous to a simple pendulum, being that there are no frictional forces accounted for.

\begin{figure}[htp]
  \center
  \begin{subfigure}[c]{0.5\textwidth}
  \center
  \includegraphics[width=.55\textwidth,frame]{olsnap1}
  \caption{Frame Snapshot near Simulation \\Initiation}
  \label{fig:olsnap1}
\end{subfigure}%
\begin{subfigure}[c]{0.5\textwidth}
  \center
  \includegraphics[width=.55\textwidth,frame]{olsnap2}
  \caption{Frame Snapshot near Simulation Termination}
  \label{fig:olsnap2}
\end{subfigure}
  \caption{Open-Loop Control Simulation Animation Snapshots}
  \label{fig:olsnaps}
\end{figure}
\looseness=-1

\begin{figure}[htp]
  \center
  \includegraphics[width=.95\textwidth]{oljplots1}
  \caption{Joint Angles vs Time in Open-Loop Simulation}
  \label{fig:oljplots1}
\end{figure}
\begin{figure}[htp]
  \center
  \includegraphics[width=.95\textwidth]{oljplots2}
  \caption{Joint Angles vs Time in Open-Loop Simulation}
  \label{fig:oljplots2}
\end{figure}
\begin{figure}[htp]
  \center
  \includegraphics[width=.95\textwidth]{oljplots3}
  \caption{Joint Angles vs Time in Open-Loop Simulation}
  \label{fig:oljplots3}
\end{figure}

\newpage
\subsection{Closed-Loop Simulation}
The motor equation (\ref{eq:fin}) gives an expression for the motor torques, however the system dynamics are defined in terms of geometric joint angles. The inclusion of differential drive systems means that the joint angles, $\gamma$ do not directly correspond to motor rotations, $\theta$. However, there is a linear relation between them, described in equation (\ref{eq:A}).
\begin{equation}
  \gamma = A\theta\quad \text{where}~~A=\left[\begin{array}{cccccc}{1 /(2 N)} & {1 /(2 N)} & {0} & {0} & {0} & {0} \\ {1 /(2 N)} & {-1 /(2 N)} & {0} & {0} & {0} & {0} \\ {0} & {0} & {-1 / N} & {0} & {0} & {0} \\ {0} & {0} & {0} & {1} & {0} & {0} \\ {0} & {0} & {0} & {0} & {-1 / 2} & {1 / 2} \\ {0} & {0} & {0} & {0} & {1 / 2} & {1 / 2}\end{array}\right]
\label{eq:A}
\end{equation}
Equation (\ref{eq:A}) can be used to map the joint angles to the motor angles. The gear ratio of 1:10 is represented by the variable N. Similarly, the motor angles can be determined by multiplying both sides of equation (\ref{eq:A}) by the inverse of matrix A, giving the following relation.
\begin{equation}
\theta=A^{-1} \gamma
\label{eq:Ainv}
\end{equation}
It is important to note that the virtual work done by the joint torques ($F_{\gamma}$) and the virtual work done by the motor torques ($F_{\theta}$) are equal. Using equation (\ref{eq:Ainv}), a linear relation between the joint torques and motor torques can be determined.
\[
\begin{aligned}
  \delta W = F_{\theta}^{T} \delta \theta&=F_{\gamma}^{T} \delta \gamma, \text { where } \delta \gamma=A \delta \theta \\
  F_{\theta}^{T} \delta \theta &= F_{\gamma}^{T}(A \delta \theta) \\
  F_{\theta}^{T}&=F_{\gamma}^{T} A\\
  \left(F_{\theta}^{T}\right)^{T}&=\left(F_{\gamma}^{T} A\right)^{T}\\
  F_{\theta}=A^{T} F_{\gamma} &\Leftrightarrow F_{\gamma}=A^{-T} F_{\theta}\qquad\quad
\end{aligned}
\]
Using this equation, a relation can be determined between the motor dynamics and the system dynamics given in equation (\ref{eq:fin}) and equation (\ref{eq:eoms}) respectively.

\[
H(\gamma) \ddot{\gamma}+d(\gamma, \dot{\gamma})+G(\gamma)=-A^{-T}\left(C_1A^{-1} \ddot{\gamma}+C_2 A^{-1} \dot{\gamma}+C_3 \theta_{d}- C_3A^{-1} \gamma\right)
\]
\begin{equation}
\ddot{\gamma}=H(\gamma)^{-1}\left(-A^{-T}\left(C_1 A^{-1} \ddot{\gamma}+C_2 A^{-1} \dot{\gamma}+C_3 \theta_{d}-C_3A^{-1} \gamma\right)-d(\gamma, \dot{\gamma})-G(\gamma)\right)
\label{eq:gddot}
\end{equation}

Because this equation includes the motor model, which in turn includes an internal PD controller, this equation can be integrated to solve for the system response given a desired motor angle input, $\theta_d$. However, doing so will not result in the desired system response. This control scheme does not have any compensation for the inertia of the links, and it is also lacking gravity compensation. This can be remedied by modifying the input to the motors, $\theta_d$. A new input, $u$, is defined such that gravity can be compensated. Thus, the motor input term in equation (\ref{eq:gddot}) must include both compensation for gravity and the desired motor angle.
\[
A^{-T} C_3  u=G(\gamma)+d(\gamma, \dot{\gamma})+A^{-T} C_3\theta_{d}
\]
\begin{equation}
u=\left(A^{-T} C_3\right)^{-1} G(\gamma)+\theta_{d}
\end{equation}
With this new motor input, the closed loop control system equations of motion are given as:
\begin{equation}
\ddot{\gamma}=H(\gamma)^{-1}\left(-A^{-T}\left(C_1 A^{-1} \ddot{\gamma}+C_2 A^{-1} \dot{\gamma}+C_3 u-C_3A^{-1} \gamma\right)-d(\gamma, \dot{\gamma})-G(\gamma)\right)
\label{eq:gddotfin}
\end{equation}
Equation (\ref{eq:gddotfin}) can then be integrated to solve for the system response given desired motor angles.

\begin{figure}[htp]
  \center
  \begin{subfigure}[c]{0.33\textwidth}
    \center
    \includegraphics[width=.9\textwidth,frame]{clsnap1}
    \caption{Frame Snapshot near Simulation \\Initiation}
  \end{subfigure}%
  \begin{subfigure}[c]{0.33\textwidth}
    \center
    \includegraphics[width=.9\textwidth,frame]{clsnap2}
    \caption{Frame Snapshot near Simulation \\Middle}
  \end{subfigure}%
\begin{subfigure}[c]{0.33\textwidth}
  \center
  \includegraphics[width=.9\textwidth,frame]{clsnap3}
  \caption{Frame Snapshot near Simulation \\Termination}
\end{subfigure}
  \caption{Closed-Loop Control Simulation Animation Snapshots}
  \label{fig:clsnaps}
\end{figure}

% The closed-loop system can now be simulated, the results are shown below in Figure (\ref{fig:jplots}).
\begin{figure}[htp]
  \center
  \includegraphics[width=.95\textwidth]{cljplots1}
  \caption{Joint Angles vs Time in Closed-Loop Simulation}
  \label{fig:cljplots1}
\end{figure}
\begin{figure}[htp]
  \center
  \includegraphics[width=.95\textwidth]{cljplots2}
  \caption{Joint Angles vs Time in Closed-Loop Simulation}
  \label{fig:cljplots2}
\end{figure}
\begin{figure}[htp]
  \center
  \includegraphics[width=.95\textwidth]{cljplots3}
  \caption{Joint Angles vs Time in Closed-Loop Simulation}
  \label{fig:cljplots3}
\end{figure}

\newpage
\subsection{ANSYS}
With 100\% infill, 3D printed PLA has a maximum shear stress of 13.6 kpsi. The manipulator applies a load of 13N in the negative y-direction. Without gears in the base differential, the differential support would bear the load on its bearing mounts. \emph{Figure \ref{fig:tbar}} shows the manipulator’s differential support could experience up to 97 kPa or 0.014 kpsi of shear stress, which is less than the maximum shear stress of PLA with 100\% infill. Since some of the manipulator’s mass is supported by the gears, the actual shear experienced by the differential support will be less.

\begin{figure}[htp]
  \center
  \includegraphics[width=.99\textwidth, frame]{tbar}
  \caption{T-Bar ANSYS FEA}
  \label{fig:tbar}
\end{figure}

To simulate a dynamical loading situation where the manipulator would be under the largest amount of stress, gravitational forces and an outward force (parallel to the arm direction in it's zeroed configuration) were applied to the structure. This situation represents the worst-case loading scenario, such as the manipulator swinging while outstretched. The supports and simulated forces can be seen in the ANSYS image capture shown in \emph{Figure \ref{fig:ansys_forces}}. \\

\begin{figure}[htp]
  \center
  \includegraphics[width=.99\textwidth, frame]{ansys_forces}
  \caption{ANSYS Simulated Forces Image Capture}
  \label{fig:ansys_forces}
\end{figure}
As shown in \emph{Figure \ref{fig:ansys_forces}}, the red arrow is the outward force simulating centrifugal forces, the yellow arrow represents gravity acting at the manipulator's center of mass, and the yellow highlighted faces show the fixed support at the base.

The dynamical loadings resulted in a maximum shear stress at the shoulder differential bearing, as seen in \emph{Figure \ref{fig:ansys_full}}; a close-up image of the bearing analysis can be seen in \emph{Figure \ref{fig:ansys_bearing}}.

\begin{figure}[htp]
  \center
  \begin{subfigure}[t]{0.5\textwidth}
  \center
  \includegraphics[width=.9\textwidth,frame]{ansys_full}
  \caption{ANSYS Full View of Maximum Shear}
  \label{fig:ansys_full}
\end{subfigure}%
\begin{subfigure}[t]{0.5\textwidth}
  \center
  \includegraphics[width=.75\textwidth,frame]{ansys_bearing}
  \caption{ANSYS Bearing Shear Stress Close-up}
  \label{fig:ansys_bearing}
\end{subfigure}
  \caption{ANSYS FEA of Dynamical Loading Scenario}
\end{figure}

To further validate that the structure is capable of handling alternating stresses, a fatigue test was also performed showing the life of the manipulator handles a minimum of 1e6 cycles, as seen in \emph{Figure \ref{fig:ansys_life}}, showing it is unlikely to fail due to material yeilding.
\newpage

\begin{figure}[htp]
  \center
  \includegraphics[width=.99\textwidth, frame]{ansys_life}
  \caption{ANSYS Fatigue Test}
  \label{fig:ansys_life}
\end{figure}

As seen in \emph{Figure \ref{fig:ansys_life}}, the lower bearing of the differential drive on the shoulder of the manipulator would be the most likely component to fail under repeating loadings.
\newpage
\subsection{Electrical Schematic}
The electrical schematic shown in \emph{Figure \ref{fig:eschem}} consists of a power supply that receives 120V AC that is standardly supplied from wall outlets. The Power supply has two outputs, a 5V terminal that has a max current output of 3A, and a 12V terminal that has a max output of 7A. The Raspberry Pi 3B is powered by the 5V terminal, and since the max current draw from the Pi is 1.2A the maximum current draw from the terminal is not surpassed. The six MX-12W servos used in the manipulator, as well as the AX-12A servo used in the end effector, are connected in parallel across the 12V terminal from the power supply. Since the MX-12W has a stall current of .6A and the AX-12A has a stall current of 1.5A, the maximum current to be pulled from the 12V terminal would be 5.1A, less than the 7A the supply can output. In order to communicate to the servos, a U2D2 communication converter is connected to the Raspberry Pi which creates a serial connection used by the servos, allowing the servos to be daisy-chained together. The Raspberry Pi also connects to an external PC so that the user can communicate with the Pi using a mouse, keyboard, and monitor.

\begin{figure}[htp]
  \centering
  \includegraphics[width=.95\textwidth]{eschem}
  \caption{Electrical Schematic}
  \label{fig:eschem}
\end{figure}

\subsection{Software Flowchart}
% The software the system will need will take in a row vector of position, orientation, path type, and end effector function information for all points to be traveled through and run the manipulator through the desired points following the specified paths requested. To do this, the user will first be asked what the number of points being input will be so that a few data structures can be preallocated. The user will then be asked if the manipulator will be writing or doing pick and place, and store the response. If the user is doing pick and place, the user will be asked for the full point data consisting of the x, y, and z location in millimeters, the phi, theta, and psi angles in degrees, the path type, and the end effector function. If the user is doing writing, only the x, y, and z locations will be requested. The orientation of the point will be defaulted in the “down” orientation since the marker will be held vertically, the path type will be set to cartesian straight line, and the end effector function will be set to stay unchanged. When all the desired points have been input, the software will then create intermediate points every centimeter between points whose paths are specified as cartesian straight line and store the new path points in a different data structure. After the path has been created, each point will be run through inverse kinematics to get the required joint angles to achieve the position and will be stored as the motor data for each point. If the user is writing with the manipulator, the user will be prompted to press a key to close the end effector to grab the marker. The user will then be prompted to press a key to begin, at which point the software will send the motor data to each servo for the first point that the system is trying to reach, wait till the servos are in the desired position, run the end effector function if there is one, and then repeat the process with the next set of motor data until all the points have been traveled through. When the last point has been reached, the program will prompt the user to input the number of desired points and wait for the input to start the process over again.

The software the system uses takes in a row vector of position, orientation, path type, and end effector function information for all points to be traveled through and runs the manipulator through the desired points following the specified paths requested. The general overview of the code is shown in \emph{Figure \ref{fig:soverall}}.
\begin{figure}[htp]
  \center
  \includegraphics[width=\textwidth]{soverall}
  \caption{General Software Algorithm Overview}
  \label{fig:soverall}
\end{figure}
\emph{Figure \ref{fig:soverall}} shows that the software for the manipulator is broken up into six subsections, two sections that receive data, three that do calculations, and one that runs the specified task.

The first subsection of the software works to receive the number of points the user is inputting as well as the general task the user is completing, shown in \emph{Figure \ref{fig:sf1}}.
\begin{figure}[htp]
  \center
  \includegraphics[width=\textwidth]{sf1}
  \caption[Software Flowchart Subsections]{Software Flowchart Subsection 1}
  \label{fig:sf1}
\end{figure}
\emph{Figure \ref{fig:sf1}} specifies that the software prompts the user for the number of points that the manipulator will travel through and stores the input as a variable, in this case ‘x’. The ‘x’ variable is only used to help preallocate data vectors so that the size of the vector does not change with each input. The software also receives the task specification as either a 0 for cartesian straight line pathing or a 1 for a straight line in the joint space and stores this value in the variable ‘c’.

The second general block in the software flowchart works to receive and store the necessary data for the points the user is inputting depending on the path type as seen in \emph{Figure \ref{fig:sf2}}.

\begin{figure}[htp]
  \center
  \includegraphics[width=\textwidth]{sf2}
  \caption[]{Software Flowchart Subsection 2}
  \label{fig:sf2}
\end{figure}

\emph{Figure \ref{fig:sf2}} shows that the path type variable ‘c’ is used to determine what information is necessary to collect. If the user is doing a writing task, the software only collects the x, y, and z distances for the point and assumes that the end effector orientation will be facing down so that the marker is vertical. If the user is doing pick and place, the software prompts the user for the x, y, z, phi, theta, psi, path type, and end effector data. The software loops until all the points have been input.

The next block in the software flowchart calculates the total points necessary to complete the task. The overview for this section can be seen in \emph{Figure \ref{fig:sf3}}.

\begin{figure}[htp]
  \center
  \includegraphics[width=\textwidth]{sf3}
  \caption[]{Software Flowchart Subsection 3}
  \label{fig:sf3}
\end{figure}

As seen in \emph{Figure \ref{fig:sf3}}, the section of software calculates the distance between the current point and the previous point if the path type is cartesian straight line and divides the distance by ten to find the number of centimeters between the two points. This value is stored as the necessary number of intermediate points, and the software will loop through until every point has been checked. The section of code also stores the total number of points that will be used as the variable level for later use.

The fourth code block in the flowchart creates and stores the necessary intermediate points along the desired path, shown in \emph{Figure \ref{fig:sf4}}.

\begin{figure}[htp]
  \center
  \includegraphics[width=.99\textwidth]{sf4}
  \caption[]{Software Flowchart Subsection 4}
  \label{fig:sf4}
\end{figure}
\looseness=-1

The code shown in \emph{Figure \ref{fig:sf4}} creates points every centimeter if the path type is cartesian straight line using the number of path points stored for each point from the previous block of software. This ensures that a straight line will be followed between the two user input points. If the path type is a straight line in the joint space, the software does not add any intermediate points since the path seen in the cartesian space does not matter.

The fifth code block in the flowchart calculates inverse kinematics of the points defined in the previous block of code and stores the angles as counts that can be used by the servos. The overview of this section can be seen in \emph{Figure \ref{fig:sf5}}.

\begin{figure}[htp]
  \center
  \includegraphics[width=\textwidth]{sf5}
  \caption[]{Software Flowchart Subsection 5}
  \label{fig:sf5}
\end{figure}

\emph{Figure \ref{fig:sf5}} shows that the new points found in the prior section of code are run through an inverse kinematics function that will output the necessary counts the servos can utilize. The code iterates through each point until the inverse kinematics have been calculated for all points.

The final block in the software diagram runs the manipulator through the desired task, with this section of code requiring user input at certain stages depending on the path type, seen in \emph{Figure \ref{fig:sf6}}.
\begin{figure}[htp]
  \center
  \includegraphics[width=\textwidth]{sf6}
  \caption[]{Software Flowchart Subsection 6}
  \label{fig:sf6}
\end{figure}

The code in \emph{Figure \ref{fig:sf6}} prompts the user to press space to close the end effector and grab the marker if drawing was the specified task, otherwise the software jumps straight into prompting the user to begin the task, and when the user begins the task the counts for each position are sent to the servos one at a time. The counts for the next position are not sent to the servos until the servos have reached the desired positions and the end effector function has been completed if there is one.

% \includepdf[landscape,pages=-]{sflow}
\newpage
\subsection{Project Status and Future}
\begin{itemize}[label=---]
  \item Print Differential
  \item Cut Aluminum Supports
  \item Print Base
  \item Print Link 1
  \item Test Link 1 and Differential
  \item Print Differential Support
  \item Test Differential
  \item Test Link 1 Pulleys
  \item Test Link 1 with Motors
  \item Test Motor Control of Differential
  \item Test Link 1 With Load
  \item Implement Kinematics in Python
  \item Test Kinemtics with Motors
\end{itemize}
% The Gantt chart can be seen on the following page.
% \includepdf[landscape,pages=-]{gantt}
\newpage
\subsection{Parts List}
\emph{Table \ref{tab:bom1}} lists the parts MEIOSIS will require to build the manipulator. The total cost is \$629.22 including shipping. Specification 1.1b required MEIOSOS’s cost to develop the manipulator be less than \$800. In addition to pulley belts for the current configuration, \emph{Table \ref{tab:bom1}} allocates \$20 for two additional belt sizes to increase joint 1/2’s and joint 3’s torque by a factor of 10. One belt size and the belt must be purchased in packs of 3 from Automation Direct. \emph{Table \ref{tab:bom1}}  accounts for increased cable lengths of 500 mm to communication bus signals from motor 2 to 3 and motor 3 to 4 and 350 mm to communication bus signals from motor 5 to 6. Motors are identified in [ZACK’S FIGURE]. Aside from electronic hardware, Figure ZZ accounts for physical hardware: To 100 threaded press-fit inserts. The manipulator will require between 21 and 46 inserts. The majority of inserts attach MX-12W servos to the manipulator. Mounting hardware accompanies each servo.
%TODO: [ZACK’S FIGURE] ^

\renewcommand{\arraystretch}{1.25}
\begin{table}[htp]
  \center
  \caption{MEIOSIS Bill of Materials with Costs}
  \label{tab:bom1}
\begin{tabular}{cC{3cm}@{\hskip 3pt}c@{\hskip 3pt}C{3cm}@{\hskip 3pt}|C{3cm}}
\multirow{2}{*}{\textbf{Part}} & \multirow{2}{*}{\textbf{Retailer}} & \multirow{2}{*}{\textbf{Quantity}} & \textbf{Unit Cost (USD)} & \textbf{Total Cost (USD)} \\\hline
3 pack, 300 tooth & \multirow{4}{*}{\shortstack[c]{Automation \\Direct}} & 1 & 11.5 & 11.5 \\
3 pack, 208 tooth &  & 1 & 9.5 & 28.5 \\
Base second belts &   & 1 & 10 & 10 \\
Link 3 second belts & & 1 & 10 & 10 \\\arrayrulecolor{gray}\hline
MX-12W & \multirow{4}{*}{\shortstack[c]{Trossen \\Robotics}} & 6 & 65.9 & 395.4 \\
500 mm, 1/2 pulleys &  & 2 & 3.95 & 7.9 \\
350 mm, 3 pulley &  & 1 & 2.95 & 2.95 \\
EE &  & 1 & 24.95 & 24.95 \\\arrayrulecolor{gray}\hline
Pi 3 B & \multirow{2}{*}{Amazon} & 1 & 37.99 & 37.99 \\
Bearings &  & 1 & 8.99 & 8.99 \\\arrayrulecolor{gray}\hline
\multirow{2}{*}{2 Sch 10 12" Al tube} & Industrial Metal Sales & 1 & 2.99 & 2.99 \\\arrayrulecolor{gray}\hline
\multirow{2}{*}{12 V, 5 V power supply} & Digi-Key Electronics & 1 & 43.21 & 43.21 \\\arrayrulecolor{gray}\hline
Automation Direct & \multirow{5}{*}{Shipping} & \multirow{5}{*}{---} & \multirow{5}{*}{---} & 0 \\
Trossen Robotics &  &  & & 13.15 \\
Amazon & &  & & 0 \\
Industrial Metal Sales &  & &  & 26.36 \\
Digi-Key &  & &  & 8.99 \\
& & & \textbf{Total} & 629.22 \\
\end{tabular}
\end{table}

In addition to the costs listed in \emph{Table \ref{tab:bom1}}, \emph{Table \ref{tab:bom2}} shows all further costs for the end-user. Since the Embry-Riddle robotics lab has 3D printing available without affecting MEIOSIS’s \$800 budget, \emph{Table \ref{tab:bom2}} accounts for outsourced 3D printing costs sufficient to print the entire manipulator with six sets of pulleys. If the end-user owns a 3D printer, the 3D printing cost would effectively reduce to filament cost. Additionally, \emph{Table \ref{tab:bom2}} assumes the end-user does not already possess an AX-12A servo to be used with the end-effector. Further, \emph{Table \ref{tab:bom2}} assumes the manipulator would be more accessible to end-users by using a proprietary U2D2 communication module in lieu of a soldered or bread-board circuit. The robotics lab has an AX-12A servo and U2D2 communication module MEIOSIS will use. With the aforementioned additional costs, the MEIOSIS manipulator costs the end-user \$1,007.98 including shipping costs. While \$1,007.98 is slightly above the maximum cost of \$1000 from specification 1.1a, it provides greater accessibility, which may be diminished by assuming end-users posess 3D printers.

\renewcommand{\arraystretch}{1.25}
\begin{table}[htp]
  \center
  \caption{End-User Bill of Materials with Costs}
  \label{tab:bom2}
  \begin{tabular}{C{3cm}C{3cm}@{\hskip 3pt}c@{\hskip 3pt}C{3cm}@{\hskip 3pt}|C{3cm}}
  \multirow{2}{*}{\textbf{Part}} & \multirow{2}{*}{\textbf{Retailer}} & \multirow{2}{*}{\textbf{Quantity}} & \textbf{Unit Cost (USD)} & \textbf{Total Cost (USD)} \\\hline
  Aforementioned Costs & \multirow{2}{*}{\emph{Table \ref{tab:bom1}}} & \multirow{2}{*}{---} & \multirow{2}{*}{---} & 629.22 \\
  \multirow{2}{*}{U2D2} & Trossen Robotics & \multirow{2}{*}{1} & \multirow{2}{*}{49.9} & \multirow{2}{*}{49.9}\\
  \multirow{2}{*}{EE with servo} & Trossen Robotics & \multirow{2}{*}{1} & \multirow{2}{*}{64.95} & \multirow{2}{*}{64.95} \\
  3D PLA outsourcing (incl. shipping) & \multirow{2}{*}{Craft Cloud} & \multirow{2}{*}{1} & \multirow{2}{*}{288.86} & \multirow{2}{*}{288.86} \\
  & & & \textbf{Total} & 1007.98 \\
  \end{tabular}
\end{table}
\renewcommand{\arraystretch}{1}
% \begin{enumerate}[label=\alph*.]
%   \item Description for callout a
%   \item Description for callout b
% \end{enumerate}

% Example citations:
% \cite{DBLP:journals/corr/JohnsonAL16}
% \cite{DBLP:journals/corr/abs-1803-09820}
% \cite{DBLP:journals/corr/RonnebergerFB15}


\newpage
\section*{Acknowledgements \& Attributions}
We would like to acknowledge the following people for their contibutions in creating this report.
\begin{itemize}
  \item Dr. Isenberg
  \item Dr. Schipper
\end{itemize}

\nocite{*}
\bibliographystyle{plain}
\bibliography{bibs}

\newpage
\appendix
\renewcommand\thesection{\Roman{section}}
\renewcommand\thesubsection{\roman{subsection}}
\hiddenappsec{Appendix}\label{sec:app}
% \section{Appendix}\label{sec:app}
\hiddenappsub{Relevant Figures and Materials}
% \subsection{Relevant Figures and Materials}
\begin{figure}[htp]
  \centering
  \includegraphics[frame,width=.75\textwidth]{dex}
  \caption{Cross Section of Dexterous Workspace Quadrant}
  \label{fig:dex}
\end{figure}
\hiddenappsub{CAD Drawings}
% \subsection{CAD Drawings}
The complete drawing package is attached.
\includepdf[landscape,pages=-]{drawings}
\hiddenappsub{Salient Code}
% \subsection{Salient Code}
\input{mmodel}
\vspace{10ex}

\input{meiosisfk}
\vspace{10ex}

\input{meiosisik}
\vspace{10ex}

% Code listing
%\begin{lstlisting}[frame=lines,style=Matlab-editor,basicstyle = \mlttfamily, caption=Example Code]
% Code Here
%\end{lstlisting}
% \includepdf[landscape,pages=-]{pdfname}

\end{document}
